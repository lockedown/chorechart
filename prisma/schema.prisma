// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "sqlite"
}

model Child {
  id        String   @id @default(cuid())
  name      String
  avatar    String   @default("") // emoji or initials
  balance   Float    @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  assignedChores ChoreAssignment[]
  transactions   Transaction[]
  rewardClaims   RewardClaim[]
}

model Chore {
  id          String   @id @default(cuid())
  title       String
  description String   @default("")
  value       Float    @default(0) // pocket money earned
  frequency   String   @default("one-off") // daily, weekly, one-off
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  assignments ChoreAssignment[]
}

model ChoreAssignment {
  id          String   @id @default(cuid())
  childId     String
  choreId     String
  status      String   @default("pending") // pending, completed, approved
  dueDate     DateTime?
  completedAt DateTime?
  approvedAt  DateTime?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  child Child @relation(fields: [childId], references: [id], onDelete: Cascade)
  chore Chore @relation(fields: [choreId], references: [id], onDelete: Cascade)
}

model Transaction {
  id          String   @id @default(cuid())
  childId     String
  amount      Float
  type        String   // earn, spend, bonus, deduction
  description String   @default("")
  createdAt   DateTime @default(now())

  child Child @relation(fields: [childId], references: [id], onDelete: Cascade)
}

model Reward {
  id          String   @id @default(cuid())
  title       String
  description String   @default("")
  cost        Float
  icon        String   @default("")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  claims RewardClaim[]
}

model RewardClaim {
  id        String   @id @default(cuid())
  childId   String
  rewardId  String
  createdAt DateTime @default(now())

  child  Child  @relation(fields: [childId], references: [id], onDelete: Cascade)
  reward Reward @relation(fields: [rewardId], references: [id], onDelete: Cascade)
}
